{"id":"7716e08","title":"7716e08 [open] Dev uses R5-style property instead of R4 extension for deprecated status in expand contains","body":"7716e08 [open] Dev uses R5-style property instead of R4 extension for deprecated status in expand contains\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:04:55 -0600 CST\nThis was last edited at 2026-02-08 10:52:56 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  7777116 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 26\nTolerance-ID: expand-r4-deprecated-status-representation\nRecord-ID: 307d55c7-f148-4ddc-a360-3962e4e2fe7c, 131242e8-b7fb-4c3a-a45b-680355b8a70f\n\nIn R4 $expand responses, prod and dev represent deprecated code status differently in two ways:\n\n**1. Per-code deprecated annotations on expansion.contains entries**\n\n- **security-labels (18 records)**: Prod uses R4-compatible extension `http://hl7.org/fhir/5.0/StructureDefinition/extension-ValueSet.expansion.contains.property` to convey `status: deprecated`. Dev uses R5-native `property` elements directly (e.g., `\"property\": [{\"code\": \"status\", \"valueCode\": \"deprecated\"}]`). The R4 spec does not define `property` on `expansion.contains` \u2014 that was introduced in R5.\n\n- **patient-contactrelationship (5 records) + v3-TribalEntityUS (3 records)**: Prod annotates deprecated codes with the same R5 backport extension. Dev omits the deprecated status annotation entirely \u2014 no extension and no property.\n\n**2. Expansion-level property declaration extension**\n\nProd includes an expansion-level extension `http://hl7.org/fhir/5.0/StructureDefinition/extension-ValueSet.expansion.property` that declares the \"status\" property used in per-code annotations. Dev either omits this entirely (patient-contactrelationship) or includes it with different key ordering (TribalEntityUS). This is the R5 backport mechanism for declaring expansion properties in R4.\n\n**How widespread**\n\n26 expand records across 3 ValueSets. All are R4 $expand operations containing codes from HL7 terminology CodeSystems with deprecated entries.\n\n```bash\ngrep 'extension-ValueSet.expansion.contains.property' jobs/2026-02-round-2/results/deltas/deltas.ndjson | wc -l\ngrep 'extension-ValueSet.expansion.property' jobs/2026-02-round-2/results/deltas/deltas.ndjson | wc -l\n```\n\n**Tolerance**\n\nTolerance `expand-r4-deprecated-status-representation` normalizes by stripping both per-code annotations (R5 backport extension and R5-native property) and the expansion-level property declaration extension from both sides. This eliminates the structural difference so other content differences can still surface.\n"}
{"id":"d05a4a6","title":"d05a4a6 [open] Dev omits retired status-check informational issues in validate-code OperationOutcome","body":"d05a4a6 [open] Dev omits retired status-check informational issues in validate-code OperationOutcome\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:10:26 -0600 CST\nThis was last edited at 2026-02-08 10:52:57 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  dd0055a #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 13\nTolerance-ID: missing-retired-status-check-issue\nRecord-ID: dc21c18a-fd57-429c-a51b-54bbfd23753f\n\n## Repro\n\n```bash\n# Prod\ncurl -s 'https://tx.fhir.org/r4/ValueSet/$validate-code?url=http:%2F%2Fhl7.org%2Ffhir%2FValueSet%2Fsecurity-labels%7C4.0.1&code=code8&_format=json&system=urn:ihe:xds:scheme8' \\\n  -H 'Accept: application/fhir+json'\n\n# Dev\ncurl -s 'https://tx-dev.fhir.org/r4/ValueSet/$validate-code?url=http:%2F%2Fhl7.org%2Ffhir%2FValueSet%2Fsecurity-labels%7C4.0.1&code=code8&_format=json&system=urn:ihe:xds:scheme8' \\\n  -H 'Accept: application/fhir+json'\n```\n\nProd returns 3 OperationOutcome issues: an informational `status-check` issue (\"Reference to retired ValueSet http://terminology.hl7.org/ValueSet/v3-ActUSPrivacyLaw|3.0.0\") plus two error-level issues (UNKNOWN_CODESYSTEM and not-in-vs). Dev returns only the 2 error-level issues, omitting the retired status-check informational issue entirely.\n\n## What differs\n\nWhen validating a code against a ValueSet that includes a retired sub-ValueSet, prod returns an informational status-check issue in the OperationOutcome reporting the retired reference. Dev omits this issue entirely.\n\nSpecifically, for validate-code on `http://hl7.org/fhir/ValueSet/security-labels|4.0.1` (which composes `http://terminology.hl7.org/ValueSet/v3-ActUSPrivacyLaw|3.0.0`, a retired ValueSet), prod includes:\n\n```json\n{\n  \"severity\": \"information\",\n  \"code\": \"business-rule\",\n  \"details\": {\n    \"coding\": [{\"system\": \"http://hl7.org/fhir/tools/CodeSystem/tx-issue-type\", \"code\": \"status-check\"}],\n    \"text\": \"Reference to retired ValueSet http://terminology.hl7.org/ValueSet/v3-ActUSPrivacyLaw|3.0.0\"\n  }\n}\n```\n\nDev's OperationOutcome has no such issue. All other parameters (result, system, code, message, and the two error-level issues) match between prod and dev.\n\n## How widespread\n\n13 records in deltas.ndjson. All are GET validate-code requests on `http://hl7.org/fhir/ValueSet/security-labels|4.0.1` with system `urn:ihe:xds:scheme8`. Found via:\n```\ngrep 'status-check' results/deltas/deltas.ndjson | wc -l\n```\n\nNote: the existing `hl7-terminology-cs-version-skew` tolerance already strips *draft* status-check issues for `terminology.hl7.org/CodeSystem/*` systems (bug 6edc96c). This is a separate pattern \u2014 *retired* status-check issues for ValueSet composition references.\n\n## What the tolerance covers\n\nTolerance `missing-retired-status-check-issue` strips informational status-check issues containing \"retired\" from prod's OperationOutcome, matching any validate-code operation where prod has a retired status-check issue and dev does not. Eliminates 13 records.\n"}
{"id":"dc0132b","title":"dc0132b [open] Dev SNOMED  returns URI-based name and omits most properties","body":"dc0132b [open] Dev SNOMED  returns URI-based name and omits most properties\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:30:54 -0600 CST\nThis was last edited at 2026-02-08 10:52:57 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  ddcc001 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 2170\nTolerance-ID: snomed-lookup-name-and-properties\nRecord-ID: 1a78565a-0d41-448b-b6cc-ae96754dd093\n\n## Repro\n\n```bash\n# Prod\ncurl -s 'https://tx.fhir.org/r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=446050000' -H 'Accept: application/fhir+json'\n\n# Dev\ncurl -s 'https://tx-dev.fhir.org/r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=446050000' -H 'Accept: application/fhir+json'\n```\n\nProd returns `name: \"SNOMED CT\"` with properties `copyright`, `moduleId`, `normalForm`, `normalFormTerse`, `parent`. Dev returns `name: \"http://snomed.info/sct|http://snomed.info/sct/900000000000207008/version/20250201\"` with only the `inactive` property.\n\n## What differs\n\nFor SNOMED CT CodeSystem/$lookup requests, dev differs from prod in three ways:\n\n1. **`name` parameter**: Prod returns the human-readable code system name `\"SNOMED CT\"`. Dev returns a system|version URI like `\"http://snomed.info/sct|http://snomed.info/sct/900000000000207008/version/20250201\"`. Per the FHIR R4 $lookup spec, the `name` output parameter (1..1 string) is defined as \"A display name for the code system\", so prod's value is correct.\n\n2. **Missing properties**: Prod returns properties `copyright`, `moduleId`, `normalForm`, `normalFormTerse`, `parent` (and `child` when applicable). Dev returns only `inactive`. Per the FHIR spec, \"If no properties are specified, the server chooses what to return\", but dev returns significantly fewer SNOMED-specific properties than prod.\n\n3. **Missing `abstract` parameter on R5**: For R5 SNOMED lookups (2170 of 2176 R5 records), prod returns `abstract: false` but dev omits the parameter entirely.\n\n## How widespread\n\n2186 SNOMED $lookup delta records match the name + properties pattern. The tolerance eliminates 2170 of them. The remaining 16 have additional differences beyond what this tolerance covers (e.g., designation content differences).\n\nSearch: `grep '$lookup.*snomed' jobs/2026-02-round-2/results/deltas/deltas.ndjson | wc -l` \u2192 2187 (before tolerance)\n\nAll three issues co-occur on every affected record.\n\n## What the tolerance covers\n\nTolerance `snomed-lookup-name-and-properties` normalizes by:\n- Setting dev's `name` to prod's value (`\"SNOMED CT\"`)\n- Removing properties from prod that dev doesn't have (copyright, moduleId, normalForm, normalFormTerse, parent, child)\n- Removing `abstract` from prod when dev doesn't have it (R5 lookups)\n\n## Representative record\n\n1a78565a-0d41-448b-b6cc-ae96754dd093 \u2014 `GET /r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=446050000`\n"}
{"id":"7b445b0","title":"7b445b0 [open] SNOMED $lookup: dev returns Synonym designation use type where prod returns Inactive","body":"7b445b0 [open] SNOMED $lookup: dev returns Synonym designation use type where prod returns Inactive\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:40:35 -0600 CST\nThis was last edited at 2026-02-08 10:52:56 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  77bb444 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 4\nTolerance-ID: snomed-lookup-inactive-designation-use\nRecord-ID: eebd3d87-2015-48c3-84ac-c46d76ac23e1\n\n## Repro\n\n```bash\n# Prod\ncurl -s 'https://tx.fhir.org/r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=303071001' \\\n  -H 'Accept: application/fhir+json'\n\n# Dev\ncurl -s 'https://tx-dev.fhir.org/r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=303071001' \\\n  -H 'Accept: application/fhir+json'\n```\n\nProd returns designation \"People in the family\" with `use.code: \"73425007\"` (display: \"Inactive\"), dev returns the same designation with `use.code: \"900000000000013009\"` (display: \"Synonym (core metadata concept)\"). Also reproducible with code 116101001 where prod marks 7 of 9 designations as Inactive while dev marks none.\n\n## What differs\n\nFor SNOMED CT CodeSystem/$lookup responses containing inactive descriptions, prod marks those designations with `use.code: \"73425007\"` (display: \"Inactive\") while dev marks the same designations with `use.code: \"900000000000013009\"` (display: \"Synonym (core metadata concept)\").\n\nIn SNOMED CT, concept 73425007 identifies a description that is inactive (no longer preferred). Using Synonym (900000000000013009) instead loses the information that the description is inactive.\n\nExample for code 303071001 (Family member):\n- Prod: designation \"People in the family\" has `use.code: \"73425007\"` (Inactive)\n- Dev: same designation has `use.code: \"900000000000013009\"` (Synonym)\n\nFor code 116101001, prod marks 7 of 9 designations with Inactive use type; dev marks none as Inactive, using Synonym or FSN instead.\n\n## How widespread\n\n4 records in the delta set match this pattern. All are SNOMED $lookup operations on R4:\n- 1 record for code 303071001 (Family member)\n- 3 records for code 116101001 (Gonadotropin releasing hormone) \u2014 same code, different comparison record IDs\n\nSearch: `python3` script checking for `73425007` in prodBody across all SNOMED lookup deltas found exactly 4 matches. Broader search across all 2187 SNOMED lookups in comparison.ndjson also found only 4 records.\n\n## What the tolerance covers\n\nTolerance `snomed-lookup-inactive-designation-use` normalizes the designation use type difference by:\n- Matching SNOMED $lookup records where prod has designation use code 73425007 and dev has 900000000000013009 for the same designation value\n- Normalizing dev designations to match prod's use type when the designation text matches\n\nEliminates 4 records.\n\n## Representative records\n\n- eebd3d87-2015-48c3-84ac-c46d76ac23e1 \u2014 GET /r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=303071001\n- fcb6b89e-a38f-444f-8bcb-41eefd5509b0 \u2014 GET /r4/CodeSystem/$lookup?system=http://snomed.info/sct&code=116101001\n"}
{"id":"6b31694","title":"6b31694 [open] Dev crashes (500) on GET  with filter parameter: searchText.toLowerCase is not a function","body":"6b31694 [open] Dev crashes (500) on GET  with filter parameter: searchText.toLowerCase is not a function\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:46:25 -0600 CST\nThis was last edited at 2026-02-08 10:52:56 -0600 CST\n\nlabels: dev-crash-on-valid, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  66bb331 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 58\nTolerance-ID: expand-filter-crash\nRecord-ID: dabcdc4f-feed-4ac8-adea-8999b06187a5\n\n## Repro\n\n```bash\n# Prod (returns 200 with ValueSet expansion)\ncurl -s 'https://tx.fhir.org/r4/ValueSet/$expand?url=http://hl7.org/fhir/ValueSet/participant-role&filter=referr&count=50' \\\n  -H 'Accept: application/fhir+json'\n\n# Dev (returns 500 with error)\ncurl -s 'https://tx-dev.fhir.org/r4/ValueSet/$expand?url=http://hl7.org/fhir/ValueSet/participant-role&filter=referr&count=50' \\\n  -H 'Accept: application/fhir+json'\n```\n\nProd returns HTTP 200 with a valid ValueSet expansion. Dev returns HTTP 500 with OperationOutcome: `searchText.toLowerCase is not a function`. Reproduced with multiple filter values (`referr`, `family`, `referring`) across different ValueSets.\n\n## What differs\n\nDev returns HTTP 500 with OperationOutcome error `searchText.toLowerCase is not a function` on all GET `$expand` requests (R4 and R5) that include a `filter` parameter. Prod returns 200 with a valid ValueSet expansion.\n\nThe error is a JavaScript TypeError indicating that `searchText` is null/undefined when `.toLowerCase()` is called during filter processing.\n\n## How widespread\n\nAll 58 records matching this error in the comparison dataset. Every one is a GET `/r4/ValueSet/$expand` or `/r5/ValueSet/$expand` request with a `filter=` query parameter. They span 3 distinct ValueSets:\n- `http://hl7.org/fhir/ValueSet/participant-role` (R4 and R5)\n- `http://hl7.org/fhir/ValueSet/condition-code` (R4)\n- `http://hl7.org/fhir/ValueSet/medication-codes` (R4)\n\nSearch: `grep -c 'searchText.toLowerCase is not a function' jobs/2026-02-round-2/results/deltas/deltas.ndjson` \u2192 58\n\n## What the tolerance covers\n\nTolerance ID: `expand-filter-crash`\nMatches: GET requests to `/r[345]/ValueSet/$expand` where `filter=` is in the URL, `prod.status=200`, `dev.status=500`, and the dev response contains `searchText.toLowerCase is not a function`.\nEliminates: 58 records.\n\n## Representative records\n\n- `dabcdc4f-feed-4ac8-adea-8999b06187a5` \u2014 `GET /r4/ValueSet/$expand?url=http://hl7.org/fhir/ValueSet/participant-role&filter=referr&count=50`\n"}
{"id":"44136eb","title":"44136eb [open] Dev returns expansion codes when prod marks expansion as too-costly (both HTTP 200)","body":"44136eb [open] Dev returns expansion codes when prod marks expansion as too-costly (both HTTP 200)\n\nClaude (AI Assistant) opened this issue 2026-02-07 19:53:51 -0600 CST\nThis was last edited at 2026-02-08 10:52:56 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  4444113 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 1\nTolerance-ID: expand-toocostly-dev-returns-codes\nRecord-ID: 227d1960-bfbd-4ca4-9c10-c5614d0e62d5\n\n## Repro\n\n```bash\n# Save the request body from the record (1.2MB, includes inline CodeSystem resources)\n# Extract from: jobs/2026-02-round-2/issues/227d1960-bfbd-4ca4-9c10-c5614d0e62d5/record.json\n# python3 -c \"import json; r=json.load(open('record.json')); open('/tmp/body.json','w').write(r['requestBody'])\"\n\n# Prod\ncurl -s 'https://tx.fhir.org/r4/ValueSet/$expand' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Content-Type: application/fhir+json' \\\n  -d @/tmp/body.json | python3 -c \"import sys,json; d=json.load(sys.stdin); e=d.get('expansion',{}); print('total:', e.get('total'), 'contains:', len(e.get('contains',[])), 'toocostly:', any(x.get('url','').endswith('valueset-toocostly') for x in e.get('extension',[])))\"\n\n# Dev\ncurl -s 'https://tx-dev.fhir.org/r4/ValueSet/$expand' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Content-Type: application/fhir+json' \\\n  -d @/tmp/body.json | python3 -c \"import sys,json; d=json.load(sys.stdin); e=d.get('expansion',{}); print('total:', e.get('total'), 'contains:', len(e.get('contains',[])), 'toocostly:', any(x.get('url','').endswith('valueset-toocostly') for x in e.get('extension',[])))\"\n```\n\nProd returns `total: 0, contains: 0, toocostly: True`. Dev returns `total: None, contains: 1000, toocostly: False`.\n\n## What differs\n\nFor $expand of ValueSets that include large code systems, prod returns HTTP 200 with an empty expansion (0 codes in `contains`) and marks it with `valueset-toocostly: true` extension and `limitedExpansion: true` parameter. Dev returns HTTP 200 with 1000 codes in `expansion.contains` \u2014 it proceeds with the expansion that prod considers too costly.\n\nAfter existing normalizations strip the toocostly extension difference (tolerance `expand-toocostly-extension-and-used-codesystem`), the remaining difference is: prod has no `expansion.contains` array while dev has 1000 codes.\n\nThe observed record involves a Brazilian ValueSet (`cid10-ciap2`, URL `https://fhir.saude.go.gov.br/r4/core/ValueSet/cid10-ciap2`) that includes codes from `BRCID10` and `BRCIAP2` code systems.\n\n## How widespread\n\n1 record in the current delta file shows this exact pattern (both 200, prod empty+toocostly, dev has codes). Related but distinct from bug 44d1916 (where prod returns 422 instead of 200).\n\nSearch: checked all 56 records where prod has 0 codes and dev has >0 codes in comparison.ndjson; 55 of those have prod with no expansion metadata at all (handled by other tolerances), and only this 1 record has prod explicitly marking the expansion as too-costly with the toocostly extension.\n\n## Tolerance\n\nTolerance `expand-toocostly-dev-returns-codes` matches $expand records where both return 200, prod has the `valueset-toocostly` extension, and dev has codes in `expansion.contains` while prod does not. Skips these records since the responses are fundamentally different in content (empty vs populated expansion) and this is a known behavioral difference in expansion size enforcement.\n"}
{"id":"15f5ce0","title":"15f5ce0 [open] GET /r5/CodeSystem/$subsumes returns 400 despite valid system parameter","body":"15f5ce0 [open] GET /r5/CodeSystem/$subsumes returns 400 despite valid system parameter\n\nClaude (AI Assistant) opened this issue 2026-02-07 20:12:09 -0600 CST\nThis was last edited at 2026-02-08 10:52:55 -0600 CST\n\nlabels: reproduced, round:2026-02-round-2, status-mismatch, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  1155ff5 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 2\nTolerance-ID: r5-get-subsumes-status-mismatch\nRecord-ID: 065c2fa7-d80e-416a-b50d-ed4f78a48fd7\n\n\n```bash\ncurl -s 'https://tx.fhir.org/r5/CodeSystem/$subsumes?system=http://snomed.info/sct&codeA=40127002&codeB=159033005' \\\n  -H 'Accept: application/fhir+json'\n\ncurl -s 'https://tx-dev.fhir.org/r5/CodeSystem/$subsumes?system=http://snomed.info/sct&codeA=40127002&codeB=159033005' \\\n  -H 'Accept: application/fhir+json'\n```\n\nProd returns HTTP 400 with OperationOutcome: \"No CodeSystem Identified (need a system parameter, or execute the operation on a CodeSystem resource)\". Dev returns HTTP 200 with Parameters containing `{\"name\":\"outcome\",\"valueCode\":\"subsumed-by\"}`.\n\n\nGET requests to `/r5/CodeSystem/$subsumes` with `system`, `codeA`, and `codeB` query parameters return HTTP 400 from prod with an OperationOutcome error: \"No CodeSystem Identified (need a system parameter, or execute the operation on a CodeSystem resource)\". Dev returns HTTP 200 with a valid Parameters response containing the subsumption outcome.\n\nThe `system` parameter is clearly present in the URL (e.g., `system=http://snomed.info/sct`), so prod appears to fail to recognize it. POST requests to the same R5 $subsumes endpoint succeed on both prod and dev.\n\n\n2 records in the current comparison dataset, both GET requests to `/r5/CodeSystem/$subsumes` with SNOMED system:\n\n- `065c2fa7-d80e-416a-b50d-ed4f78a48fd7`: codeA=40127002, codeB=159033005 (dev: subsumed-by)\n- `d48aa838-d4f2-492a-aedb-5562103b1ae3`: codeA=159033005, codeB=309414002\n\nFound via: `grep '/r5/CodeSystem/\\$subsumes' comparison.ndjson` \u2014 3 total records, of which 2 are GET (both failing) and 1 is POST (succeeding).\n\nNo R4 $subsumes records exist in the dataset for comparison.\n\n\nTolerance ID `r5-get-subsumes-status-mismatch` skips GET requests to `/r5/CodeSystem/$subsumes` where prod=400 and dev=200. Eliminates 2 records.\n"}
{"id":"f9f6206","title":"f9f6206 [open] validate-code: dev renders JavaScript undefined/null as literal strings when code/version absent","body":"f9f6206 [open] validate-code: dev renders JavaScript undefined/null as literal strings when code/version absent\n\nClaude (AI Assistant) opened this issue 2026-02-07 20:17:29 -0600 CST\nThis was last edited at 2026-02-08 10:52:57 -0600 CST\n\nlabels: content-differs, reproduced, round:2026-02-round-2, tx-compare\nactors: Claude (AI Assistant)\nparticipants: Claude (AI Assistant)\n\n  ff99ff6 #0 Claude (AI Assistant) <>\n\n  Records-Impacted: 1\nTolerance-ID: validate-code-undefined-null-in-unknown-code-message\nRecord-ID: 7f0c6cf8-a250-4935-8ab6-32f499d65302\n\n\n```bash\ncurl -s 'https://tx.fhir.org/r5/CodeSystem/$validate-code' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Content-Type: application/fhir+json' \\\n  -d '{\"resourceType\":\"Parameters\",\"parameter\":[{\"name\":\"coding\",\"valueCoding\":{\"system\":\"urn:ietf:bcp:47\"}},{\"name\":\"displayLanguage\",\"valueString\":\"en\"},{\"name\":\"default-to-latest-version\",\"valueBoolean\":true}]}'\n\ncurl -s 'https://tx-dev.fhir.org/r5/CodeSystem/$validate-code' \\\n  -H 'Accept: application/fhir+json' \\\n  -H 'Content-Type: application/fhir+json' \\\n  -d '{\"resourceType\":\"Parameters\",\"parameter\":[{\"name\":\"coding\",\"valueCoding\":{\"system\":\"urn:ietf:bcp:47\"}},{\"name\":\"displayLanguage\",\"valueString\":\"en\"},{\"name\":\"default-to-latest-version\",\"valueBoolean\":true}]}'\n```\n\nProd returns message `\"Unknown code '' in the CodeSystem 'urn:ietf:bcp:47' version ''\"` (empty strings for missing code/version), dev returns `\"Unknown code 'undefined' in the CodeSystem 'urn:ietf:bcp:47' version 'null'\"` (JavaScript undefined/null as literal strings). Dev also includes an extra informational issue `\"Empty code\"` that prod does not return.\n\n\nIn a POST /r5/CodeSystem/$validate-code request for system `urn:ietf:bcp:47` with a coding that has no `code` or `version`, the message and issues text differ:\n\n- Prod: `\"Unknown code '' in the CodeSystem 'urn:ietf:bcp:47' version ''\"`\n- Dev: `\"Unknown code 'undefined' in the CodeSystem 'urn:ietf:bcp:47' version 'null'\"`\n\nDev renders JavaScript's `undefined` and `null` as literal strings instead of empty strings when code and version are absent from the request.\n\nAdditionally, dev includes an extra informational OperationOutcome issue (`\"Empty code\"`, severity=information) that prod does not return.\n\nBoth servers agree on result=false and system=urn:ietf:bcp:47.\n\n\n1 record in the current delta file. Searched for broader patterns:\n- `grep \"'undefined'\" deltas.ndjson` \u2192 37 hits total, but only 2 have 'undefined' in non-diagnostics params (this record and 06cfc4c9 which has \"and undefined\" in a version list \u2014 a different pattern)\n- `grep \"version 'null'\" deltas.ndjson` \u2192 1 hit (this record only)\n- `grep \"Empty code\" deltas.ndjson` \u2192 1 hit (this record only)\n\n\nTolerance ID: validate-code-undefined-null-in-unknown-code-message\nMatches: validate-code Parameters responses where dev message contains `'undefined'` or `version 'null'` and prod has the same message but with empty strings. Normalizes the message and issues text to prod's rendering, and removes the extra \"Empty code\" informational issue from dev. Eliminates 1 delta record.\n\n\n`grep -n '7f0c6cf8-a250-4935-8ab6-32f499d65302' comparison.ndjson`\n"}
